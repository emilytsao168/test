# 1112 PDL Project:看圖算數學
---
本專案利用簡單的Convolutional Neural Network來實作辨識圖片中的數字及運算符號，並且根據辨識出的數字及運算符號進行運算。
---
## 輸入資料格式
### 圖片
給定⼀張圖⼤⼩是200\*60像素，辨識圖中的數字(0~9)及運算⼦(加+/減-/乘\*)，共9個字元，輸出數學運算結果(整數)。
      
![p0](https://github.com/emilytsao168/test/assets/117272534/1ba33342-8f46-4319-8dba-818b411a2798)
### 標籤     

由「train_data01.csv」中匯入每張圖片的標籤，其中的格式為「0	6 0 4 5 4 - 5 + 8 =	60457」

---
## 資料預處理
### 圖片降噪
透過dealImg(path)進行圖片的降噪。      

![下載](https://github.com/emilytsao168/test/assets/117272534/dbaa8a33-6630-4dae-bcd7-58fd2af85026)      

```python     
def dealImg(path):
    # 獲取圖片img物件
    img = getImg(path)
    # 將彩色圖片轉換為灰度圖片
    grayImg = toGrayImg(img)
    # 將灰度圖片二值化
    binImg = toBinImg(grayImg)
    noiseImg = binImg
    # 對圖片進行降噪
    noiseImg = noiseReduction(noiseImg)
    return noiseImg
``` 
### 標籤處理
原本從csv檔中讀到的str標籤「0	6 0 4 5 4 - 5 + 8 =	60457」     
將標籤中的運算符號 (加+/減-/乘\*) 分別轉換為 (10, 11, 12)     
並將所有標籤儲存成[6, 0, 4, 5, 4, 11, 5, 10, 8]格式     
最後將標籤轉換為 one-hot 編碼      

### 將圖片和標籤打包
將圖片和標籤打包成一個元組，並且儲存為「data_50000_v1.pkl」     
資料預處理完成！

---
## 讀入資料並建立模型
### 讀入資料並進行處理
將前面經過預處理的圖片及標籤讀入，並且將資料以8:2的比例切割為訓練資料及測試資料     
因為我們的模型是多輸出的結構，為了符合之後模型的輸入格式，需要對於標籤形狀進行修改     
原本的標籤格式：     
```
[[第一張第1個數字,...,第一張第9個數字], [第二張第1個數字,...,第二張第9個數字], [...], [...], [...], [...]]
```
修改後的標籤格式：     
```
[[第一張第1個數字,...,最後一張第1個數字], [第一張第2個數字,...,最後一張第2個數字], [...], [...], [...], [...]]
```
